<!DOCTYPE html>
<html>
	<head>
		<title>canvas test</title>
		<style>
			
		</style>
	</head>
	<body>
		<input id=inp oninput='getDensity(this.value)'/>
		<canvas id=canvas width=350 height=10000></canvas>
		<script>
let ctx=canvas.getContext("2d");
var items={};
var scheme=[
	"#822a33",
	"#D22A77",
	"#f00",
	"#0ef",
	"#808080",
	"#fa0",
	"#a5c710",
	"#6517bf",
	"#754f23",
	"#ffd",
	"#93d9c7",
	"#474747",
	"#888",
	"#afbdb7",
	"#B3C77A",
	"#FF00E4",
	"#FB0",
	"#36AF5D",
	"#7A001E",
	"#85FFD6",
	"#C4BC34",
	"#000C6A",
	"#FD9CFF",
	"#59CAFF",
	"#156F36",
	"#AF0085",
	"#DA9B5E",
	"#D6E300",
	"#7A687F",
	"#ff0",
	"#0f0",
	"#0ff",
	"#00f",
	"#fff",
	"#eee",
	"#ddd",
	"#ccc",
	"#bbb",
	"#aaa",
	"#999",
	"#888",
	"#777",
	"#666",
	"#555",
	"#444",
	"#333",
	"#222",
	"#111",
	"#000"
]
function getDensity(str){
	let len=str.length
	items={}
	let diameter=Math.max(canvas.width,canvas.height)
	ctx.clearRect(0,0,diameter,diameter);
	str.split("").forEach((e,i)=>{
		if(!items[e]){
			items[e]=[1,scheme[i]]
		}else{
			items[e][0]+=1
		}
	})
	let total=Object.keys(items).reduce((s,k)=>s+parseFloat(items[k]||0),0);
	let dist=25
	let x=0;
	let ca=0;
	Object.keys(items).forEach(e=>{
		items[e][2]=x*dist;
		x++
		let pa=(items[e][0]/total)*2*Math.PI;
		ctx.beginPath();
		ctx.arc(100,100,100,ca,ca+pa);
		ca+=pa;
		ctx.lineTo(100,100);
		ctx.rect(220,items[e][2],dist/2,dist/2);
		ctx.fillStyle="#000";
		ctx.fill();
		ctx.font="15px monospace";
		let dec=1e3
		ctx.fillText(e+" "+items[e][0]+"("+Math.round(items[e][0]/total*dec*10)/dec+")%",235,items[e][2]+(25/2));
		ctx.fillStyle=items[e][1];
		ctx.fill();
	})
}
		</script>
	</body>
</html>